var Q,main,Conf,libURLContext="./libs/",coreLibs=["xwebjs"];function enableCache(){"serviceWorker"in navigator&&navigator.serviceWorker.register("CacheSupport.js",{scope:"/"}).then(function(e){console.log("The file cache support service worker has been registered successfully")}).catch(function(e){console.log("Failed to register the file cache support:"+e)})}function enablePromise(e){scriptUtil.load(libURLContext+"q.js",function(){e()})}var scriptUtil={load:function(e,n,o){var i=document.createElement("script");i.onerror=o,n&&(i.onload=n),document.head.appendChild(i),i.src=e}};function loadDependentLibs(n,o){function i(e){console.log("Failed to load lib:"+o[t]+" because:"+e)}var t=0,c=Q.defer(),r=function(e){console.log("Library "+o[t]+" is loaded"),++t===o.length?c.resolve():scriptUtil.load(n+o[t]+".js",r,i)};return scriptUtil.load(n+o[t]+".js",r,i),c.promise}function invokeMainFn(){"M"===Conf.entryType?_x.initVM().then(function(){var e=_x.getRootVM();e.setConfiguration(_.clone(Conf)),e.init()}):_.isFunction(main)?main():console.log("Main function or method is not defined")}function init(){enableCache(),enablePromise(function(){loadDependentLibs(libURLContext,coreLibs).then(function(){invokeMainFn()}).catch(function(e){console.log("Failed to start the program because:"+e)})})}window.onload=init;